
<!-- ä¾§è¾¹å¯¼èˆª -->
<nav class="admin-sidebar">
    <div class="nav-title">ç®¡ç†é¢æ¿</div>
    <ul class="nav-menu">
        <li class="nav-item" data-panel="user" id="userShow"><a href="/administer/showUserModule">ğŸ‘¤ ç”¨æˆ·ç®¡ç†</a></li>
        <li class="nav-item active" data-panel="comment" id="commentShow"><a href="/administer/showCommentModule">ğŸ’¬ è¯„è®ºç®¡ç†</a></li>
        <li class="nav-item" data-panel="house" id="houseShow"><a href="/administer/showHouseModule">ğŸ  ä½æˆ¿ç®¡ç†</a></li>
        <li class="nav-item" data-panel="order" id="orderShow"><a href="/administer/showOrderModule">ğŸ“¦ è®¢å•ç®¡ç†</a></li>
        <li class="nav-item" data-panel="stats"><a href="/administer/showStatsModule">ğŸ“Š æ•°æ®ç»Ÿè®¡</a></li>
    </ul>

    <ul>
        <li class="user-item">ç®¡ç†å‘˜ï¼š{{.userName}}</li>
        <li class="user-item"><a href="/administer/logout">é€€å‡º</a></li>
    </ul>
</nav>

<!-- ä¸»å†…å®¹åŒº -->
<main class="admin-main">
    <!-- è¯„è®ºç®¡ç† -->
    <div class="dashboard-panel">
        <div class="panel-header">è¯„è®ºç®¡ç†</div>
        <div class="search-bar">
            <form action="/administer/commentOperation" method="get">
                <input type="text" placeholder="æœç´¢è¯„è®º" name="comment">
                <button type="submit" class="action-btn">æœç´¢</button>
            </form>
        </div>
        <div class="comment-list">
            {{range .orderGoods}}
            {{if compare .Comment ""}}
            {{else}}
            <div class="comment-item">
                <div class="comment-meta">
                    <span>
                        <img src="http://192.168.117.132:8888/{{.GoodsSKU.Image}}" alt="">
                        <em>{{.GoodsSKU.Name}}</em>
                    </span>
                    <span>åœ°å€ï¼š{{.GoodsSKU.Addr}}</span>
                    <span>ç”¨æˆ·ï¼š{{.OrderInfo.User.Name}}</span>
                    <span>å‘å¸ƒæ—¶é—´ï¼š{{.CommentTime}}</span>
                </div>
                <div class="comment-content">è¯„ä»·ï¼š{{.Comment}}</div>
                <div class="action-btns">
                    <button class="action-btn comment-delete-btn">åˆ é™¤</button>
                </div>
            </div>
            {{end}}
            {{end}}
        </div>
    </div>
</main>

<script>
    $(document).ready(function() {
        // è¯„è®ºåˆ é™¤æŒ‰é’®
        $('.comment-delete-btn').click(function () {
            if (confirm('ç¡®å®šåˆ é™¤è¯¥è¯„è®ºï¼Ÿ')) {
                const $item = $(this).closest('.comment-item');
                // æå–å•†å“åç§°
                const goodsName = $item.find('.comment-meta em').text().trim();
                // æå–ç”¨æˆ·ä¿¡æ¯ï¼ˆå‡è®¾ç”¨æˆ·ä¿¡æ¯åœ¨ç¬¬äºŒä¸ªspanï¼‰
                const userName = $item.find('.comment-meta span:eq(1)').text().replace('ç”¨æˆ·ï¼š', '').trim();

                param = {'goodsName': goodsName, 'userName': userName}
                $.ajaxSettings.async = false
                $.post('/administer/commentOperation', param, function (response) {
                    if (response.code === 0) {
                        // ç§»é™¤å¯¹åº”å…ƒç´ 
                        $item.fadeOut(300, () => $item.remove());
                    } else {
                        alert(response.msg);
                    }
                });
                $.ajaxSettings.async = true
            }
        });
    });
</script>